@echo off
chcp 65001
Color f0
title Optimize Windows - Facebook: fb.com/boboiboy.gala.7 [Ho√†ng Vi·ªát Quang (T√®o Sushi)]
cls

::Ki·ªÉm tra quy·ªÅn Qu·∫£n tr·ªã vi√™n
>nul 2>&1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"
if '%errorlevel%' NEQ '0' (
    echo Requesting administrative privileges...
    goto UACPrompt
) else ( goto gotAdmin )

:UACPrompt
    echo Set UAC = CreateObject^("Shell.Application"^) > "%temp%\getadmin.vbs"
    set params = %*:"=""
    echo UAC.ShellExecute "cmd.exe", "/c ""%~s0"" %params%", "", "runas", 1 >> "%temp%\getadmin.vbs"

    "%temp%\getadmin.vbs"
    del "%temp%\getadmin.vbs"
    exit /B

:gotAdmin
 pushd "%CD%"
    CD /D "%~dp0"
cls 

::Intro (Source: Ghost Spectre)
:TeoSushi
cls && color 08
for /F "tokens=1,2 delims=#" %%a in ('"prompt #$H#$E# & echo on & for %%b in (1) do rem"') do (set "DEL=%%a")
<nul set /p=""
call :PainText 03 "                             P"
call :PainText 03 " o"
call :PainText 03 " w"
call :PainText 03 " e"
call :PainText 03 " r"
call :PainText 03 " e"
call :PainText 03 " d"
call :PainText 03 "    b"
call :PainText 03 " y"
call :PainText 0D "    T"
call :PainText 0D "  E"
call :PainText 0D "  O"
call :PainText 0D "    S"
call :PainText 0D "  U"
call :PainText 0D "  S"
call :PainText 0D "  H"
call :PainText 0D "  I"
timeout /t 3 >nul
cls
goto :end
:PainText
<nul set /p "=%DEL%" > "%~2"
findstr /v /a:%1 /R "+" "%~2" nul
del "%~2" > nul
goto :eof
:end
echo.
@echo off
:: NORMAL FOREG COLORS
set nhcolor=
set Black=%nhcolor%[30m
set Red=%nhcolor%[31m
set Green=%nhcolor%[32m
set Yellow=%nhcolor%[33m
set Blue=%nhcolor%[33m
set Magenta=%nhcolor%[35m
set Cyan=%nhcolor%[36m
set White=%nhcolor%[37m
set Lightgray=%nhcolor%[37m
:: STRONG FOREG COLORS
set SWhite=%nhcolor%[90m
set SRed=%nhcolor%[91m
set SGreen=%nhcolor%[92m
set SYellow=%nhcolor%[93m
set SBlue=%nhcolor%[94m
set SMagenta=%nhcolor%[95m
set SCyan=%nhcolor%[96m
set SWhite=%nhcolor%[97m
:: NORMALBACKGROUND
set NBlack=%nhcolor%[40m
set NRed=%nhcolor%[41m
set NGreen=%nhcolor%[42m
set NYellow=%nhcolor%[43m
set NBlue=%nhcolor%[44m
set NMagenta=%nhcolor%[45m
set NCyan=%nhcolor%[46m
set NWhite=%nhcolor%[47m
:: STRONGBACKGROUND
set BBlack=%nhcolor%[100m
set BRed=%nhcolor%[101m
set BGreen=%nhcolor%[102m
set BYellow=%nhcolor%[103m
set BBlue=%nhcolor%[104m
set BMagenta=%nhcolor%[105m
set BCyan=%nhcolor%[106m
set BWhite=%nhcolor%[107m
:: STYLE
set Green=%nhcolor%[32m
set White=%nhcolor%[37m
set Cyan=%nhcolor%[36m
set Magenta=%nhcolor%[35m
set Red=%nhcolor%[31m
set Yellow=%nhcolor%[33m
set Lightgray=%nhcolor%[37m
set Bold=%nhcolor%[1m

goto Home

:Home
color f0
cls
echo =========================================================================
Echo.
Echo                     Optimize Windows by T√®o Sushi
echo.
Echo Facebook: https://www.facebook.com/boboiboy.gala.7
Echo           Ho√†ng Vi·ªát Quang (T√®o Sushi)
Echo.
Echo Vui l√≤ng ƒë·ªçc k·ªπ HDSD tr∆∞·ªõc khi d√πng!
Echo Vui l√≤ng ƒë·ªçc k·ªπ HDSD tr∆∞·ªõc khi d√πng!
Echo Vui l√≤ng ƒë·ªçc k·ªπ HDSD tr∆∞·ªõc khi d√πng!
echo.
echo Vi·ªác g√¨ quan tr·ªçng nh·∫Øc l·∫°i 3 l·∫ßn :))
Echo.
Echo =========================================================================
Echo.
echo  Tool s·∫Ω ch·∫°y sau v√†i gi√¢y...
Echo ==============================
ping 127.0.0.1 -n 5 > nul
Goto ClearCacheBrowser

:ClearCacheBrowser
cls
echo ƒêang xo√° t·∫≠p tin t·∫°m c·ªßa c√°c tr√¨nh duy·ªát...
del /q /s "%LOCALAPPDATA%\Microsoft\Windows\INetCache\*.*"
echo ƒêang x√≥a cache tr√¨nh duy·ªát...
::T·∫Øt tr√¨nh duy·ªát web
::taskkill /im chrome.exe /f >nul 2>&1
::taskkill /im firefox.exe /f >nul 2>&1
::taskkill /im iexplore.exe /f >nul 2>&1
::taskkill /im msedge.exe /f >nul 2>&1
::echo ƒê√£ t·∫Øt tr√¨nh duy·ªát th√†nh c√¥ng!
echo ƒêang x√≥a cache...
echo ƒêang x√≥a cache tr√¨nh duy·ªát Google Chrome...
rmdir /q /s "%LOCALAPPDATA%\Google\Chrome\User Data\Default\Cache"
echo ƒê√£ x√≥a cache tr√¨nh duy·ªát Google Chrome th√†nh c√¥ng!

timeout /t 2
Cls
echo ƒêang x√≥a cache tr√¨nh duy·ªát Firefox...
rmdir /q /s "%APPDATA%\Mozilla\Firefox\Profiles\*.default\cache2"
echo ƒê√£ x√≥a cache tr√¨nh duy·ªát Firefox th√†nh c√¥ng!

timeout /t 2
Cls
echo ƒêang x√≥a cache tr√¨nh duy·ªát Internet Explorer...
RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 8
echo ƒê√£ x√≥a cache tr√¨nh duy·ªát Internet Explorer th√†nh c√¥ng!

timeout /t 2
Cls
echo ƒêang x√≥a cache tr√¨nh duy·ªát Microsoft Edge...
rmdir /q /s "%LOCALAPPDATA%\Microsoft\Edge\User Data\Default\Cache"
echo ƒê√£ x√≥a cache tr√¨nh duy·ªát Microsoft Edge th√†nh c√¥ng!

timeout /t 2
Cls
echo ƒê√£ ho√†n th√†nh vi·ªác x√≥a cache tr√¨nh duy·ªát!

echo T·∫≠p tin t·∫°m ƒë√£ ƒë∆∞·ª£c d·ªçn!
goto ClearBin

:ClearBin
Cls
for /D %%d in (C:\ D:\ E:\ F:\ G:\ H:\ I:\ J:\ K:\ L:\ M:\ N:\ O:\ P:\ Q:\ R:\ S:\ T:\ U:\ V:\ W:\ X:\ Y:\ Z:\) do (
    if exist "%%d\$Recycle.Bin" (
        echo Deleting files in %%d\$Recycle.Bin...
        rd /s /q "%%d\$Recycle.Bin"
    )
)
Goto Heathcheck

:Heathcheck

Cls
echo D·ªçn d·∫πp cache v√† t·ªáp t·∫°m th·ªùi...
del /f /s /q "%USERPROFILE%\AppData\Local\Microsoft\Windows\Temporary Internet Files\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Cache\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Cookies"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\History"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\JumpListIcons\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Media Cache\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Media History"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\QuotaManager"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Thumbnails\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Web Data"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Web Data-journal"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\GPUCache\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\IndexedDB\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Local Storage\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Microsoft\Windows\WebCache\*.*"
del /f /s /q "%USERPROFILE%\AppData\Local\Temp\*.*"
del /f /s /q "%WINDIR%\Logs\CBS\*.*"
del /f /s /q "%WINDIR%\Logs\DISM\*.*"
del /f /s /q "%WINDIR%\Logs\EventLog\*.*"
del /f /s /q "%WINDIR%\Logs\System32\*.*"
del /f /s /q "%WINDIR%\Prefetch\*.*"
del /f /s /q "%USERPROFILE%\Recent\*.*"
echo D·ªçn d·∫πp ho√†n t·∫•t.
goto ClearCache

:ClearCache

timeout /t 2
cls
echo "ƒêang x√≥a c√°c t·ªáp t·∫°m v√† t·∫≠p tin r√°c..."
:: X√≥a c√°c t·ªáp t·∫°m v√† t·∫≠p tin r√°c
del /q /f /s %temp%\*
del /f /s /q %TEMP%\*
del /f /s /q %SystemRoot%\Temp\*
rd /s /q %SystemRoot%\Prefetch
rd /s /q %SystemRoot%\SoftwareDistribution\Download
rd /s /q %SystemRoot%\Logs\CBS
rd /s /q %SystemRoot%\Minidump
rd /s /q %SystemRoot%\MemoryDiagnostics
rd /s /q %SystemRoot%\ServiceProfiles\LocalService\AppData\Local\Microsoft\Windows\INetCache
rd /s /q %SystemRoot%\ServiceProfiles\NetworkService\AppData\Local\Microsoft\Windows\INetCache
rd /s /q %USERPROFILE%\AppData\Local\Microsoft\Windows\INetCache
rd /s /q %USERPROFILE%\AppData\Local\Temp
rd /s /q %USERPROFILE%\AppData\Local\Google\Chrome\User Data\Default\Cache
for /d %%i in ("C:\Users\*") do del /q /f /s "%%i\AppData\Local\Temp\*.*"
del /q /f /s %windir%\Prefetch\*
@echo on
for /f "tokens=*" %%a in ('wevtutil.exe el') do wevtutil.exe cl "%%a"
@echo off
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management" /v DisablePagingExecutive /t REG_DWORD /d 1 /f
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem" /v NtfsDisableLastAccessUpdate /t REG_DWORD /d 1 /f

timeout /t 2

echo ƒêang x√≥a c√°c file t·∫°m v√† r√°c...

REM ƒê∆∞·ªùng d·∫´n c·∫ßn x√≥a
set paths=C:\Users\Administrator\AppData\Local\Microsoft\Edge\User Data\Default\Sessions
set paths=%paths%;C:\Users\Administrator\AppData\Local\Microsoft\Windows\INetCache\IE\VXX40LCM
set paths=%paths%;C:\Users\Administrator\AppData\Local\Temp
set paths=%paths%;C:\Windows\Temp
set paths=%paths%;C:\Windows\Installer\$PatchCache$\Managed\1926E8D15D0BCE53481466615F760A7F\10.0.40219

for %%i in (%paths%) do (
    echo ƒêang x√≥a c√°c file trong th∆∞ m·ª•c %%i...
    del /f /s /q "%%i\*.*"
)

echo ƒê√£ x√≥a c√°c file t·∫°m v√† r√°c th√†nh c√¥ng.
timeout /t 2
Cls
echo "ƒêang ch·∫°y Disk Cleanup..."
:: Ch·∫°y Disk Cleanup
cleanmgr /sagerun:1

timeout /t 2
cls
:DeepCleanup
timeout /t 2
Cls

echo Xo√° c√°c b·∫£n c·∫≠p nh·∫≠t th·ª´a c·ªßa Windows Update...
echo.

echo ƒêang t√¨m ki·∫øm c√°c b·∫£n c·∫≠p nh·∫≠t th·ª´a...
DISM.exe /Online /Cleanup-Image /AnalyzeComponentStore

echo.
echo ƒêang xo√° c√°c b·∫£n c·∫≠p nh·∫≠t th·ª´a...
DISM.exe /Online /Cleanup-Image /StartComponentCleanup /ResetBase

echo.
echo Xo√° c√°c b·∫£n c·∫≠p nh·∫≠t th·ª´a th√†nh c√¥ng!

timeout /t 2
cls
REM Xo√° c√°c b·∫£n c·∫≠p nh·∫≠t th·ª´a c·ªßa Windows ƒë·ªÉ gi·∫£i ph√≥ng kh√¥ng gian ƒëƒ©a
echo ƒêang t√¨m c√°c b·∫£n c·∫≠p nh·∫≠t th·ª´a...
DISM /Online /Get-Packages /Format:Table | findstr /C:"Superseded" > "%temp%\list.txt"
for /F "tokens=1,*" %%A in ('type "%temp%\list.txt"') do (
echo ƒêang xo√° b·∫£n c·∫≠p nh·∫≠t: %%B
DISM /Online /Remove-Package /PackageName:%%B /quiet /norestart
)
echo Xo√° c√°c b·∫£n c·∫≠p nh·∫≠t th·ª´a th√†nh c√¥ng.

timeout /t 2
cls
echo ƒêang d·ªçn s·∫°ch c√°c file t·∫°m th·ªùi c·ªßa h·ªá th·ªëng...
del /F /Q %temp%\*
del /F /Q %systemroot%\Temp\*
echo.

echo ƒêang xo√° b·ªô nh·ªõ cache c·ªßa Internet Explorer...
RunDll32.exe InetCpl.cpl,ClearMyTracksByProcess 8
echo.

echo ƒêang xo√° c√°c file t·∫°m th·ªùi c·ªßa Edge...
del /F /Q %localappdata%\Packages\Microsoft.MicrosoftEdge*\AC\#!001\*
echo.

echo ƒê√£ ho√†n th√†nh vi·ªác d·ªçn s·∫°ch h·ªá th·ªëng v√† cache tr√¨nh duy·ªát web.
Goto End

:End 
Cls 
echo ƒê√£ ho√†n th·∫£nh!
Echo.
echo Tool s·∫Ω t·ª± ƒë·ªông t·∫Øt sau v√†i gi√¢y...
ping 127.0.0.1 -n 4 > nul
exit